<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>The Looper</title>

    <!-- Внутренние ссылки -->
    <link
      class="local style"
      rel="stylesheet"
      href="./style.css"
      type="text/css"
    />
    <!-- Внешние ссылки -->
    <link
      class="external style"
      rel="stylesheet"
      href="https://cbipope3ka.github.io/TheLooper/style.css"
      type="text/css"
      disabled
    />
  </head>

  <body>
    <button
      class="isolated"
      style="width: 100%; height: 3rem"
      onclick="toggleExternalLinks()"
    >
      О НЕТ, ПОЧЕМУ ЖЕ ВСЁ СЛОМАЛОСЬ?!
    </button>
    <div class="nav">
      <div id="buttons">
        <form>
          <label for="file-input-txt">Загрузить лог (TXT)</label>
          <input type="file" id="file-input-txt" />
        </form>
        <label>
          <input type="checkbox" id="keepOOCCheckbox" checked>OOC
        </label>
        

        <form>
          <button for="file-input-html">(HTML)</button>
          <input type="file" id="file-input-html" />
        </form>

        <div id="keywords">
          <!--         <input type="text" id="keywordsInput" placeholder="Введите ключевые слова через запятую"
            onkeypress="handleKeyPress(event)"
            value="Запись, фото, улыбочку, -шепчет, -ООС, -[МИА]"> -->

          <!--           <input
            type="text"
            id="keywordsInput"
            placeholder="Введите ключевые слова через запятую"
            onkeypress="handleKeyPress(event)"
            value="Фэрриан, Ананита, Кэролай, -ООС, Икар, Шанталь, Тианна, -шепчет, Зверолов, Дерек, Карл, Сэнди, Фг, Аран, Хитрец, Сэверус, Джанетт, Патрульный Бёрд, Самсон, Ларин"
          /> -->

          <input
            type="text"
            id="keywordsInput"
            placeholder="Введите ключевые слова через запятую"
            value=" , -ООС, -шепч"
          />

          <button onclick="Filter()">Фильтр</button>
        </div>
        <button onclick="removeNonselectedParagraphs()">Чистка</button>
        <button onclick="oocToEmote()">OOC =&gt; Emote</button>
        <button onclick="removeCollapsed()">Коллапс</button>
        <button onclick="chapterReverse()">Реверс</button>
        <button onclick="removePlayers()">Удалить игроков</button>
        <button onclick="debug()">Дебаг</button>
        <button onclick="selectAll()">Выбрать всё</button>
        <button onclick="toggleChapters()">Свернуть</button>
        <button onclick="exportHTML()">HTML</button>
        <!--  
        <button onclick="postReplace()">Постреплейс</button>
        <button onclick="combineFunctions()">Чатбоксы</button>
        <button onclick="toggleVisibility('dm')">DM</button>
        <button onclick="toggleVisibility('ooc')">OOC</button>
        <button onclick="emoteToSpeech()">Emote =&gt; Say</button>
        <button onclick="sayToEmote()">Say =&gt; Emote</button>
        <button onclick="killNav()">Kill Nav</button> -->
      </div>
    </div>
    <div id="chatlog"></div>
    <div class="footer"></div>
  </body>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="script.js"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
    integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>

  <script>
    function toggleExternalLinks() {
      var externalLinks = document.querySelectorAll(".external");

      // Переключаем атрибут disabled у всех внешних ссылок
      externalLinks.forEach(function (link) {
        link.toggleAttribute("disabled");
      });

      function loadExternalContent() {
        var xhr = new XMLHttpRequest();

        // Путь к внешнему HTML-файлу
        var url = "https://cbipope3ka.github.io/TheLooper/nav.html";

        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            // Заменяем содержимое элемента с классом "nav" загруженным HTML
            document.querySelector(".nav").innerHTML = xhr.responseText;
          }
        };

        xhr.open("GET", url, true);
        xhr.send();
      }

      // ЗАМЕНЯЕМ ЛОКАЛЬНЫЙ СКРИПТ НА ВНЕШНИЙ
      // Находим существующий script элемент с src "script.js"
      var existingScript = document.querySelector('script[src="script.js"]');

      existingScript.parentNode.replaceChild(
        Object.assign(document.createElement("script"), {
          src: "https://cbipope3ka.github.io/TheLooper/script.js",
          async: true, // Добавляем атрибут async
        }),
        existingScript
      );
    }
  </script>
</html>
